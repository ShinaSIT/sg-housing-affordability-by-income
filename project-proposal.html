<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shina Shih Xin Rong (2402781)">
<meta name="author" content="Jeanie Cherie Chua Yue-Ning (2403083)">
<meta name="author" content="Claudia Yue Xin Ying (2401817)">
<meta name="author" content="Nurul Zahirah Binte Muhamadnoh (2401671)">
<meta name="author" content="Anushka Chourasia (2503769)">
<meta name="dcterms.date" content="2001-02-05">

<title>Project Proposal – Income vs Prices (Singapore, 2010–?)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="project-proposal_files/libs/clipboard/clipboard.min.js"></script>
<script src="project-proposal_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="project-proposal_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="project-proposal_files/libs/quarto-html/popper.min.js"></script>
<script src="project-proposal_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="project-proposal_files/libs/quarto-html/anchor.min.js"></script>
<link href="project-proposal_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="project-proposal_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="project-proposal_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="project-proposal_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="project-proposal_files/libs/bootstrap/bootstrap-813c323200a87c37e262811031999de4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#project-proposal-income-vs-prices-singapore-2010" id="toc-project-proposal-income-vs-prices-singapore-2010" class="nav-link active" data-scroll-target="#project-proposal-income-vs-prices-singapore-2010"><span class="header-section-number">1</span> Project Proposal – Income vs Prices (Singapore, 2010–?)</a>
  <ul class="collapse">
  <li><a href="#chosen-visualization-and-story" id="toc-chosen-visualization-and-story" class="nav-link" data-scroll-target="#chosen-visualization-and-story"><span class="header-section-number">1.1</span> 1. Chosen Visualization and Story</a>
  <ul class="collapse">
  <li><a href="#visualization-example-original" id="toc-visualization-example-original" class="nav-link" data-scroll-target="#visualization-example-original"><span class="header-section-number">1.1.1</span> 1.1 Visualization Example (Original)</a></li>
  <li><a href="#intended-story-key-message" id="toc-intended-story-key-message" class="nav-link" data-scroll-target="#intended-story-key-message"><span class="header-section-number">1.1.2</span> 1.2 Intended Story / Key Message</a></li>
  </ul></li>
  <li><a href="#strengths-and-weaknesses-of-the-original-visualization" id="toc-strengths-and-weaknesses-of-the-original-visualization" class="nav-link" data-scroll-target="#strengths-and-weaknesses-of-the-original-visualization"><span class="header-section-number">1.2</span> 2. Strengths and Weaknesses of the Original Visualization</a>
  <ul class="collapse">
  <li><a href="#strengths" id="toc-strengths" class="nav-link" data-scroll-target="#strengths"><span class="header-section-number">1.2.1</span> 2.1 Strengths</a></li>
  <li><a href="#weaknesses" id="toc-weaknesses" class="nav-link" data-scroll-target="#weaknesses"><span class="header-section-number">1.2.2</span> 2.2 Weaknesses</a></li>
  </ul></li>
  <li><a href="#proposed-improvements-and-justifications" id="toc-proposed-improvements-and-justifications" class="nav-link" data-scroll-target="#proposed-improvements-and-justifications"><span class="header-section-number">1.3</span> 3. Proposed Improvements and Justifications</a>
  <ul class="collapse">
  <li><a href="#reduce-the-number-of-income-groups-displayed" id="toc-reduce-the-number-of-income-groups-displayed" class="nav-link" data-scroll-target="#reduce-the-number-of-income-groups-displayed"><span class="header-section-number">1.3.1</span> 3.1 Reduce the Number of Income Groups Displayed</a></li>
  <li><a href="#improve-comparison-between-income-and-prices" id="toc-improve-comparison-between-income-and-prices" class="nav-link" data-scroll-target="#improve-comparison-between-income-and-prices"><span class="header-section-number">1.3.2</span> 3.2 Improve Comparison Between Income and Prices</a></li>
  <li><a href="#incorporate-purchasing-power-real-income" id="toc-incorporate-purchasing-power-real-income" class="nav-link" data-scroll-target="#incorporate-purchasing-power-real-income"><span class="header-section-number">1.3.3</span> 3.3 Incorporate Purchasing Power (Real Income)</a></li>
  <li><a href="#improve-visual-hierarchy-and-narrative" id="toc-improve-visual-hierarchy-and-narrative" class="nav-link" data-scroll-target="#improve-visual-hierarchy-and-narrative"><span class="header-section-number">1.3.4</span> 3.4 Improve Visual Hierarchy and Narrative</a></li>
  </ul></li>
  <li><a href="#data-sources" id="toc-data-sources" class="nav-link" data-scroll-target="#data-sources"><span class="header-section-number">1.4</span> 4. Data Sources</a>
  <ul class="collapse">
  <li><a href="#household-income-by-income-decile" id="toc-household-income-by-income-decile" class="nav-link" data-scroll-target="#household-income-by-income-decile"><span class="header-section-number">1.4.1</span> Household Income by Income Decile</a></li>
  <li><a href="#consumer-price-index-cpi-all-items" id="toc-consumer-price-index-cpi-all-items" class="nav-link" data-scroll-target="#consumer-price-index-cpi-all-items"><span class="header-section-number">1.4.2</span> Consumer Price Index (CPI – All Items)</a></li>
  <li><a href="#hdb-resale-price-index" id="toc-hdb-resale-price-index" class="nav-link" data-scroll-target="#hdb-resale-price-index"><span class="header-section-number">1.4.3</span> HDB Resale Price Index</a></li>
  <li><a href="#optional-contextual-datasets" id="toc-optional-contextual-datasets" class="nav-link" data-scroll-target="#optional-contextual-datasets"><span class="header-section-number">1.4.4</span> Optional / Contextual Datasets</a></li>
  </ul></li>
  <li><a href="#data-workflow-raw-to-visualization-ready" id="toc-data-workflow-raw-to-visualization-ready" class="nav-link" data-scroll-target="#data-workflow-raw-to-visualization-ready"><span class="header-section-number">1.5</span> 5. Data Workflow: Raw to Visualization-Ready</a>
  <ul class="collapse">
  <li><a href="#raw-data-ingestion" id="toc-raw-data-ingestion" class="nav-link" data-scroll-target="#raw-data-ingestion"><span class="header-section-number">1.5.1</span> 5.1 Raw Data Ingestion</a></li>
  <li><a href="#data-cleaning-and-standardisation" id="toc-data-cleaning-and-standardisation" class="nav-link" data-scroll-target="#data-cleaning-and-standardisation"><span class="header-section-number">1.5.2</span> 5.2 Data Cleaning and Standardisation</a></li>
  <li><a href="#data-transformation-and-aggregation" id="toc-data-transformation-and-aggregation" class="nav-link" data-scroll-target="#data-transformation-and-aggregation"><span class="header-section-number">1.5.3</span> 5.3 Data Transformation and Aggregation</a></li>
  <li><a href="#validation-and-quality-checks" id="toc-validation-and-quality-checks" class="nav-link" data-scroll-target="#validation-and-quality-checks"><span class="header-section-number">1.5.4</span> 5.4 Validation and Quality Checks</a></li>
  <li><a href="#final-tidy-dataset" id="toc-final-tidy-dataset" class="nav-link" data-scroll-target="#final-tidy-dataset"><span class="header-section-number">1.5.5</span> 5.5 Final Tidy Dataset</a></li>
  </ul></li>
  <li><a href="#optional-planned-data-analysis" id="toc-optional-planned-data-analysis" class="nav-link" data-scroll-target="#optional-planned-data-analysis"><span class="header-section-number">1.6</span> 6. (Optional) Planned Data Analysis</a></li>
  <li><a href="#planned-work-distribution" id="toc-planned-work-distribution" class="nav-link" data-scroll-target="#planned-work-distribution"><span class="header-section-number">1.7</span> 7. Planned Work Distribution</a></li>
  <li><a href="#appendix-optional-alternative-design-concepts" id="toc-appendix-optional-alternative-design-concepts" class="nav-link" data-scroll-target="#appendix-optional-alternative-design-concepts"><span class="header-section-number">1.8</span> Appendix (Optional): Alternative Design Concepts</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project Proposal – Income vs Prices (Singapore, 2010–?)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Shina Shih Xin Rong (2402781) </p>
             <p>Jeanie Cherie Chua Yue-Ning (2403083) </p>
             <p>Claudia Yue Xin Ying (2401817) </p>
             <p>Nurul Zahirah Binte Muhamadnoh (2401671) </p>
             <p>Anushka Chourasia (2503769) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 5, 2001</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="project-proposal-income-vs-prices-singapore-2010" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Project Proposal – Income vs Prices (Singapore, 2010–?)</h1>
<section id="chosen-visualization-and-story" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="chosen-visualization-and-story"><span class="header-section-number">1.1</span> 1. Chosen Visualization and Story</h2>
<section id="visualization-example-original" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="visualization-example-original"><span class="header-section-number">1.1.1</span> 1.1 Visualization Example (Original)</h3>
<p>The original visualization, <strong>“Average Household Income Per Household vs Purchasing Power Index (PPI)”</strong>, combines stacked bar charts representing average household income across income deciles with an overlaid Purchasing Power Index (PPI) line across time. The intention of the visualization is to compare income growth with changes in purchasing power at a national level.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Average-Household-Income-Per-Household-Image.jpg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="intended-story-key-message" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="intended-story-key-message"><span class="header-section-number">1.1.2</span> 1.2 Intended Story / Key Message</h3>
<p>The refined research question guiding this project is:</p>
<p><strong>Does a high local purchasing power index translate into affordability across income groups, or does it primarily reflect outcomes for higher-income households?</strong></p>
<p>While average household income shows an upward trend across most income deciles between 2010 and 2019 (with a decline in 2020), rising housing prices suggest that improvements in purchasing power and affordability may not be evenly experienced. This project aims to highlight how aggregated indicators may mask distributional differences in affordability across income groups in Singapore.</p>
</section>
</section>
<section id="strengths-and-weaknesses-of-the-original-visualization" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="strengths-and-weaknesses-of-the-original-visualization"><span class="header-section-number">1.2</span> 2. Strengths and Weaknesses of the Original Visualization</h2>
<section id="strengths" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="strengths"><span class="header-section-number">1.2.1</span> 2.1 Strengths</h3>
<ul>
<li>Provides a clear high-level comparison between income growth and purchasing power.</li>
<li>Time-series structure allows identification of long-term trends and periods of divergence.</li>
<li>Familiar and accessible chart design suitable for non-technical audiences.</li>
<li>Inclusion of income deciles acknowledges income heterogeneity across households.</li>
</ul>
</section>
<section id="weaknesses" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="weaknesses"><span class="header-section-number">1.2.2</span> 2.2 Weaknesses</h3>
<ul>
<li>Dual-axis design may lead to visual misinterpretation.</li>
<li>Displaying multiple income deciles simultaneously creates visual clutter.</li>
<li>Lack of direct affordability metrics, particularly for essential costs such as housing.</li>
<li>No breakdown of cost categories, limiting insight into affordability pressures.</li>
<li>Stacked bars reduce comparability across income groups.</li>
<li>Aggregated purchasing power obscures distributional affordability outcomes.</li>
</ul>
</section>
</section>
<section id="proposed-improvements-and-justifications" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="proposed-improvements-and-justifications"><span class="header-section-number">1.3</span> 3. Proposed Improvements and Justifications</h2>
<section id="reduce-the-number-of-income-groups-displayed" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="reduce-the-number-of-income-groups-displayed"><span class="header-section-number">1.3.1</span> 3.1 Reduce the Number of Income Groups Displayed</h3>
<p>Income groups will be aggregated into broader categories (Bottom 20%, Middle 60%, Top 20%) to reduce cognitive load and improve interpretability.</p>
</section>
<section id="improve-comparison-between-income-and-prices" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="improve-comparison-between-income-and-prices"><span class="header-section-number">1.3.2</span> 3.2 Improve Comparison Between Income and Prices</h3>
<p>The stacked bar chart will be replaced with a faceted line chart to enable clearer comparison of income and housing price trends across income groups.</p>
</section>
<section id="incorporate-purchasing-power-real-income" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="incorporate-purchasing-power-real-income"><span class="header-section-number">1.3.3</span> 3.3 Incorporate Purchasing Power (Real Income)</h3>
<p>Household income will be adjusted using CPI to reflect real income changes, improving interpretation of purchasing power.</p>
</section>
<section id="improve-visual-hierarchy-and-narrative" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="improve-visual-hierarchy-and-narrative"><span class="header-section-number">1.3.4</span> 3.4 Improve Visual Hierarchy and Narrative</h3>
<p>Clear titles, consistent scales, and annotations will be used to guide interpretation and highlight divergence in affordability trends.</p>
</section>
</section>
<section id="data-sources" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="data-sources"><span class="header-section-number">1.4</span> 4. Data Sources</h2>
<p>The datasets used in this project are obtained from official Singapore government sources to ensure reliability, consistency, and relevance.</p>
<section id="household-income-by-income-decile" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="household-income-by-income-decile"><span class="header-section-number">1.4.1</span> Household Income by Income Decile</h3>
<ul>
<li><strong>Source</strong>: Department of Statistics Singapore (SingStat)<br>
</li>
<li><strong>Dataset</strong>: Average Monthly Household Income by Income Decile<br>
</li>
<li><strong>URL</strong>: https://tablebuilder.singstat.gov.sg/table/CT/17880<br>
</li>
<li><strong>Justification</strong>: This dataset provides a disaggregated view of household income across income deciles, which is essential for analysing distributional differences in affordability outcomes.</li>
</ul>
</section>
<section id="consumer-price-index-cpi-all-items" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="consumer-price-index-cpi-all-items"><span class="header-section-number">1.4.2</span> Consumer Price Index (CPI – All Items)</h3>
<ul>
<li><strong>Source</strong>: Department of Statistics Singapore (SingStat)<br>
</li>
<li><strong>URL</strong>: https://www.singstat.gov.sg/whats-new/latest-news/cpi-highlights<br>
</li>
<li><strong>Justification</strong>: CPI is used to adjust nominal household income into real terms, allowing purchasing power and affordability trends to be analysed more accurately over time.</li>
</ul>
</section>
<section id="hdb-resale-price-index" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="hdb-resale-price-index"><span class="header-section-number">1.4.3</span> HDB Resale Price Index</h3>
<ul>
<li><strong>Source</strong>: data.gov.sg (Housing &amp; Development Board)<br>
</li>
<li><strong>URL</strong>: https://data.gov.sg/collections/189/view<br>
</li>
<li><strong>Justification</strong>: The HDB resale price index is used as a proxy for housing costs, which represent the largest expenditure component for most Singapore households.</li>
</ul>
</section>
<section id="optional-contextual-datasets" class="level3" data-number="1.4.4">
<h3 data-number="1.4.4" class="anchored" data-anchor-id="optional-contextual-datasets"><span class="header-section-number">1.4.4</span> Optional / Contextual Datasets</h3>
<p>The following datasets were explored for contextual understanding but are not used in the final visualization: - Private Residential Property Price Index – https://data.gov.sg/collections/1676/view<br>
- Rental Price Indices – https://data.gov.sg/datasets/d_c9f57187485a850908655db0e8cfe651/view</p>
</section>
</section>
<section id="data-workflow-raw-to-visualization-ready" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="data-workflow-raw-to-visualization-ready"><span class="header-section-number">1.5</span> 5. Data Workflow: Raw to Visualization-Ready</h2>
<section id="raw-data-ingestion" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="raw-data-ingestion"><span class="header-section-number">1.5.1</span> 5.1 Raw Data Ingestion</h3>
<p>Raw datasets are downloaded from official sources and aligned to a common annual time range (2010 onwards).</p>
</section>
<section id="data-cleaning-and-standardisation" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="data-cleaning-and-standardisation"><span class="header-section-number">1.5.2</span> 5.2 Data Cleaning and Standardisation</h3>
<p>Data is inspected for missing values and inconsistencies. Time variables and income group labels are standardised, and irrelevant fields are removed.</p>
</section>
<section id="data-transformation-and-aggregation" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="data-transformation-and-aggregation"><span class="header-section-number">1.5.3</span> 5.3 Data Transformation and Aggregation</h3>
<p>Nominal income values are adjusted using CPI where necessary. Income and housing price series are converted into normalised indices (base year = 100) and aggregated to annual frequency.</p>
</section>
<section id="validation-and-quality-checks" class="level3" data-number="1.5.4">
<h3 data-number="1.5.4" class="anchored" data-anchor-id="validation-and-quality-checks"><span class="header-section-number">1.5.4</span> 5.4 Validation and Quality Checks</h3>
<p>Merged datasets are validated to ensure accurate alignment across time and income groups, with checks for duplication or data loss.</p>
</section>
<section id="final-tidy-dataset" class="level3" data-number="1.5.5">
<h3 data-number="1.5.5" class="anchored" data-anchor-id="final-tidy-dataset"><span class="header-section-number">1.5.5</span> 5.5 Final Tidy Dataset</h3>
<p>The final dataset is reshaped into long format with variables: Year, Income Group, Measure Type, and Index Value, suitable for faceted line chart visualisation.</p>
</section>
</section>
<section id="optional-planned-data-analysis" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="optional-planned-data-analysis"><span class="header-section-number">1.6</span> 6. (Optional) Planned Data Analysis</h2>
<p>Descriptive and comparative trend analysis will be conducted to: - Compare income and housing price growth rates across income groups. - Identify periods where housing prices outpace income growth. - Support visual annotations highlighting divergence or convergence trends.</p>
<p>The analysis is descriptive and not causal.</p>
</section>
<section id="planned-work-distribution" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="planned-work-distribution"><span class="header-section-number">1.7</span> 7. Planned Work Distribution</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 40%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="header">
<th>Team Member</th>
<th>Responsibilities</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Shina Shih Xin Rong</td>
<td>Project coordination, narrative development, Quarto assembly</td>
</tr>
<tr class="even">
<td>Jeanie Cherie Chua Yue-Ning</td>
<td>Data collection and cleaning</td>
</tr>
<tr class="odd">
<td>Claudia Yue Xin Ying</td>
<td>Data transformation and index construction</td>
</tr>
<tr class="even">
<td>Nurul Zahirah Binte Muhamadnoh</td>
<td>Visualization design and implementation</td>
</tr>
<tr class="odd">
<td>Anushka Chourasia</td>
<td>Data validation and analysis support</td>
</tr>
</tbody>
</table>
</section>
<section id="appendix-optional-alternative-design-concepts" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="appendix-optional-alternative-design-concepts"><span class="header-section-number">1.8</span> Appendix (Optional): Alternative Design Concepts</h2>
<p>Alternative visualization designs and additional cost indicators were explored during the ideation phase but not adopted to maintain clarity and focus on a single visualization.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>